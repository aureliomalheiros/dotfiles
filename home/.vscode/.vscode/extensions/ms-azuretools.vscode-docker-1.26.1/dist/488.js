"use strict";exports.id=488,exports.ids=[488],exports.modules={71488:(e,n,t)=>{t.r(n),t.d(n,{BE_PROFILE:()=>p,NRT_PROFILE:()=>_,PostChannel:()=>oe,RT_PROFILE:()=>v});var a=t(27421),r=t(29141),i=t(81782),o=t(47954),s=t(87624),u=t(65705),l=t(24869),c=t(49251),d=t(28452),f=t(29339),h=t(87951),v="REAL_TIME",_="NEAR_REAL_TIME",p="BEST_EFFORT",y="",m="POST",g="drop",S="send",T="requeue",b="rspFail",E="application/x-json-stream",P="cache-control",C="content-type",R="kill-tokens",B="kill-duration",M="time-delta-millis",w="client-version",x="client-id",k="time-delta-to-apply-millis",A="upload-time",O="apikey",K="AuthMsaDeviceTicket",H="AuthXToken",L="msfpc",F="trace",q="user";function _getEventMsfpc(e){var n=(e.ext||{}).intweb;return n&&(0,u.Sn)(n[L])?n[L]:null}function _getMsfpc(e){for(var n=null,t=0;null===n&&t<e.length;t++)n=_getEventMsfpc(e[t]);return n}var D=function(){function EventBatch(e,n){var t=n?[].concat(n):[],a=this,r=_getMsfpc(t);a.iKey=function(){return e},a.Msfpc=function(){return r||y},a.count=function(){return t.length},a.events=function(){return t},a.addEvent=function(e){return!!e&&(t.push(e),r||(r=_getEventMsfpc(e)),!0)},a.split=function(n,a){var i;if(n<t.length){var o=t.length-n;(0,l.le)(a)||(o=a<o?a:o),i=t.splice(n,o),r=_getMsfpc(t)}return new EventBatch(e,i)}}return EventBatch.create=function(e,n){return new EventBatch(e,n)},EventBatch}();const Q=function(){function ClockSkewManager(){var e=!0,n=!0,t=!0,a="use-collector-delta",i=!1;(0,r.Z)(ClockSkewManager,this,(function(r){r.allowRequestSending=function(){return e},r.firstRequestSent=function(){t&&(t=!1,i||(e=!1))},r.shouldAddClockSkewHeaders=function(){return n},r.getClockSkewHeaderValue=function(){return a},r.setClockSkew=function(t){i||(t?(a=t,n=!0,i=!0):n=!1,e=!0)}}))}return ClockSkewManager.__ieDyn=1,ClockSkewManager}();const I=function(){function KillSwitch(){var e={};(0,r.Z)(KillSwitch,this,(function(n){n.setKillSwitchTenants=function(n,t){if(n&&t)try{var a=function _normalizeTenants(e){var n=[];return e&&(0,l.tO)(e,(function(e){n.push((0,l.nd)(e))})),n}(n.split(","));if("this-request-only"===t)return a;for(var r=1e3*parseInt(t,10),i=0;i<a.length;++i)e[a[i]]=(0,l.m6)()+r}catch(e){return[]}return[]},n.isTenantKilled=function(n){var t=e,a=(0,l.nd)(n);return void 0!==t[a]&&t[a]>(0,l.m6)()||(delete t[a],!1)}}))}return KillSwitch.__ieDyn=1,KillSwitch}();var N=t(1550);function retryPolicyGetMillisToBackoffForRetry(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)}var z,U=2e6,j=Math.min(U,65e3),W="metadata",J="f",X=/\./,V=function(){function Serializer(e,n,t,a){var o="data",s="baseData",c=!!a,d=n,f={};(0,r.Z)(Serializer,this,(function(n){function _processPathKeys(e,n,a,r,i,o,s){(0,l.rW)(e,(function(e,h){var v=null;if(h||(0,u.Sn)(h)){var _=a,p=e,y=i,m=n;if(c&&!r&&X.test(e)){var g=e.split("."),S=g.length;if(S>1){y&&(y=y.slice());for(var T=0;T<S-1;T++){var b=g[T];m=m[b]=m[b]||{},_+="."+b,y&&y.push(b)}p=g[S-1]}}var E=r&&function _isReservedField(e,n){var t=f[e];return void 0===t&&(e.length>=7&&(t=(0,l.xe)(e,"ext.metadata")||(0,l.xe)(e,"ext.web")),f[e]=t),t}(_);if(v=!E&&d&&d.handleField(_,p)?d.value(_,p,h,t):(0,u.yj)(p,h,t)){var P=v.value;if(m[p]=P,o&&o(y,p,v),s&&"object"==typeof P&&!(0,l.kJ)(P)){var C=y;C&&(C=C.slice()).push(p),_processPathKeys(h,P,_+"."+p,r,C,o,s)}}}}))}n.createPayload=function(e,n,t,a,r,i){return{apiKeys:[],payloadBlob:y,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:a,sendType:i,sendReason:r}},n.appendPayload=function(t,a,r){var o=t&&a&&!t.overflow;return o&&(0,i.Lm)(e,(function(){return"Serializer:appendPayload"}),(function(){for(var e=a.events(),i=t.payloadBlob,o=t.numEvents,s=!1,u=[],c=[],d=t.isBeacon,f=d?65e3:3984588,h=d?j:U,v=0,_=0;v<e.length;){var p=e[v];if(p){if(o>=r){t.overflow=a.split(v);break}var y=n.getEventBlob(p);if(y&&y.length<=h){var m=y.length;if(i.length+m>f){t.overflow=a.split(v);break}i&&(i+="\n"),i+=y,++_>20&&(i.substr(0,1),_=0),s=!0,o++}else y?u.push(p):c.push(p),e.splice(v,1),v--}v++}if(u&&u.length>0&&t.sizeExceed.push(D.create(a.iKey(),u)),c&&c.length>0&&t.failedEvts.push(D.create(a.iKey(),c)),s){t.batches.push(a),t.payloadBlob=i,t.numEvents=o;var g=a.iKey();-1===(0,l.UA)(t.apiKeys,g)&&t.apiKeys.push(g)}}),(function(){return{payload:t,theBatch:{iKey:a.iKey(),evts:a.events()},max:r}})),o},n.getEventBlob=function(n){try{return(0,i.Lm)(e,(function(){return"Serializer.getEventBlob"}),(function(){var e={};e.name=n.name,e.time=n.time,e.ver=n.ver,e.iKey="o:"+(0,u.jM)(n.iKey);var t={},a=n.ext;a&&(e.ext=t,(0,l.rW)(a,(function(e,n){_processPathKeys(n,t[e]={},"ext."+e,!0,null,null,!0)})));var r=e[o]={};r.baseType=n.baseType;var i=r[s]={};return _processPathKeys(n.baseData,i,s,!1,[s],(function(e,n,a){_addJSONPropertyMetaData(t,e,n,a)}),true),_processPathKeys(n.data,r,o,!1,[],(function(e,n,a){_addJSONPropertyMetaData(t,e,n,a)}),true),JSON.stringify(e)}),(function(){return{item:n}}))}catch(e){return null}}}))}return Serializer.__ieDyn=1,Serializer}();function _addJSONPropertyMetaData(e,n,t,a){if(a&&e){var r=(0,u.Vv)(a.value,a.kind,a.propertyType);if(r>-1){var i=e[W];i||(i=e[W]={f:{}});var o=i[J];if(o||(o=i[J]={}),n)for(var s=0;s<n.length;s++){var c=n[s];o[c]||(o[c]={f:{}});var d=o[c][J];d||(d=o[c][J]={}),o=d}o=o[t]={},(0,l.kJ)(a.value)?o.a={t:r}:o.t=r}}}var Z="sendAttempt",Y="&NoResponseBody=true",G=((z={})[1]=T,z[100]=T,z[200]="sent",z[8004]=g,z[8003]=g,z),$={},ee={};function _addCollectorHeaderQsMapping(e,n,t){$[e]=n,!1!==t&&(ee[n]=e)}function _getResponseText(e){try{return e.responseText}catch(e){}return y}function _hasHeader(e,n){var t=!1;if(e&&n){var a=(0,l.FY)(e);if(a&&a.length>0)for(var r=n.toLowerCase(),i=0;i<a.length;i++){var o=a[i];if(o&&(0,l.nr)(n,o)&&o.toLowerCase()===r){t=!0;break}}}return t}function _addRequestDetails(e,n,t,a){n&&t&&t.length>0&&(a&&$[n]?(e.hdrs[$[n]]=t,e.useHdrs=!0):e.url+="&"+n+"="+t)}function _prependTransports(e,n){return n&&((0,l.hj)(n)?e=[n].concat(e):(0,l.kJ)(n)&&(e=n.concat(e))),e}_addCollectorHeaderQsMapping(K,K,!1),_addCollectorHeaderQsMapping(w,w),_addCollectorHeaderQsMapping(x,"Client-Id"),_addCollectorHeaderQsMapping(O,O),_addCollectorHeaderQsMapping(k,k),_addCollectorHeaderQsMapping(A,A),_addCollectorHeaderQsMapping(H,H);var ne=function(){function HttpManager(e,n,t,a,o){this._responseHandlers=[];var s,d,h,v,_,p,T,K,H,F,q="?cors=true&"+C.toLowerCase()+"="+E,D=new I,z=!1,U=new Q,j=!1,W=0,J=!0,X=[],$={},ne=[],te=null,ae=!1,re=!1,ie=!1;(0,r.Z)(HttpManager,this,(function(r){var Q=!0;function _getSenderInterface(e,n){for(var t=0,a=null,r=0;null==a&&r<e.length;)1===(t=e[r])?(0,c.cp)()?a=_xdrSendPost:(0,c.Z3)()&&(a=_xhrSendPost):2===t&&(0,c.JO)(n)&&(!n||n&&!K)?a=_fetchSendPost:j&&3===t&&(0,c.MF)()&&(a=_beaconSendPost),r++;return a?{_transport:t,_isSync:n,sendPOST:a}:null}function _xdrSendPost(e,n,t){var a=new XDomainRequest;a.open(m,e.urlString),e.timeout&&(a.timeout=e.timeout),a.onload=function(){var e=_getResponseText(a);_doOnComplete(n,200,{},e),_handleCollectorResponse(e)},a.onerror=function(){_doOnComplete(n,400,{})},a.ontimeout=function(){_doOnComplete(n,500,{})},a.onprogress=function(){},t?a.send(e.data):o.set((function(){a.send(e.data)}),0)}function _fetchSendPost(e,n,t){var a,r=e.urlString,i=!1,s=!1,u=((a={body:e.data,method:m}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,a);t&&(u.keepalive=!0,2===e._sendReason&&(i=!0,F&&(r+=Y))),Q&&(u.credentials="include"),e.headers&&(0,l.FY)(e.headers).length>0&&(u.headers=e.headers),fetch(r,u).then((function(e){var t={},a=y,r=e.headers;r&&r.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){a=e})),s||(s=!0,_doOnComplete(n,e.status,t,a),_handleCollectorResponse(a))})).catch((function(e){s||(s=!0,_doOnComplete(n,0,{}))})),i&&!s&&(s=!0,_doOnComplete(n,200,{})),!s&&e.timeout>0&&o.set((function(){s||(s=!0,_doOnComplete(n,500,{}))}),e.timeout)}function _xhrSendPost(e,n,t){var a=e.urlString;function _appendHeader(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var a=n.getResponseHeader(t);a&&(e[t]=(0,l.nd)(a))}return e}function _getAllResponseHeaders(e){var n={};return e.getAllResponseHeaders?n=function _convertAllHeadersToMap(e){var n={};if((0,l.HD)(e)){var t=(0,l.nd)(e).split(/[\r\n]+/);(0,l.tO)(t,(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var a=(0,l.nd)(e.substring(0,t)).toLowerCase(),r=(0,l.nd)(e.substring(t+1));n[a]=r}else n[(0,l.nd)(e)]=1}}))}return n}(e.getAllResponseHeaders()):(n=_appendHeader(n,e,M),n=_appendHeader(n,e,B),n=_appendHeader(n,e,"kill-duration-seconds")),n}function xhrComplete(e,t){_doOnComplete(n,e.status,_getAllResponseHeaders(e),t)}t&&e.disableXhrSync&&(t=!1);var r=(0,u.ot)(m,a,Q,!0,t,e.timeout);(0,l.rW)(e.headers,(function(e,n){r.setRequestHeader(e,n)})),r.onload=function(){var e=_getResponseText(r);xhrComplete(r,e),_handleCollectorResponse(e)},r.onerror=function(){xhrComplete(r)},r.ontimeout=function(){xhrComplete(r)},r.send(e.data)}function _doOnComplete(e,n,t,a){try{e(n,t,a)}catch(e){(0,f.kP)(d,2,518,(0,c.eU)(e))}}function _beaconSendPost(e,n,t){var a=200,r=e._thePayload,i=e.urlString+(F?Y:y);try{var o=(0,c.jW)();if(!o.sendBeacon(i,e.data))if(r){var s=[];(0,l.tO)(r.batches,(function(e){if(s&&e&&e.count()>0){for(var n=e.events(),t=0;t<n.length;t++)if(!o.sendBeacon(i,te.getEventBlob(n[t]))){s.push(e.split(t));break}}else s.push(e.split(0))})),_sendBatchesNotification(s,8003,r.sendType,!0)}else a=0}catch(e){(0,f.jV)(d,"Failed to send telemetry using sendBeacon API. Ex:"+(0,c.eU)(e)),a=0}finally{_doOnComplete(n,a,{},y)}}function _isBeaconPayload(e){return 2===e||3===e}function _adjustSendType(e){return re&&_isBeaconPayload(e)&&(e=2),e}function _hasIdleConnection(){return!z&&W<n}function _clearQueue(){var e=ne;return ne=[],e}function _canSendPayload(e,n,t){var a=!1;return e&&e.length>0&&!z&&h[n]&&te&&(a=0!==n||_hasIdleConnection()&&(t>0||U.allowRequestSending())),a}function _createDebugBatches(e){var n={};return e&&(0,l.tO)(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function _sendBatches(n,t,a,r,o){if(n&&0!==n.length)if(z)_sendBatchesNotification(n,1,r);else{r=_adjustSendType(r);try{var s=n,l=0!==r;(0,i.Lm)(v,(function(){return"HttpManager:_sendBatches"}),(function(i){i&&(n=n.slice(0));for(var s=[],c=null,d=(0,u.hK)(),f=h[r]||(l?h[1]:h[0]),v=f&&f._transport,_=H&&(re||_isBeaconPayload(r)||3===v||f._isSync&&2===v);_canSendPayload(n,r,t);){var p=n.shift();p&&p.count()>0&&(D.isTenantKilled(p.iKey())?s.push(p):(c=c||te.createPayload(t,a,l,_,o,r),te.appendPayload(c,p,e)?null!==c.overflow&&(n=[c.overflow].concat(n),c.overflow=null,_doPayloadSend(c,d,(0,u.hK)(),o),d=(0,u.hK)(),c=null):(_doPayloadSend(c,d,(0,u.hK)(),o),d=(0,u.hK)(),n=[p].concat(n),c=null)))}c&&_doPayloadSend(c,d,(0,u.hK)(),o),n.length>0&&(ne=n.concat(ne)),_sendBatchesNotification(s,8004,r)}),(function(){return{batches:_createDebugBatches(s),retryCount:t,isTeardown:a,isSynchronous:l,sendReason:o,useSendBeacon:_isBeaconPayload(r),sendType:r}}),!l)}catch(e){(0,f.kP)(d,2,48,"Unexpected Exception sending batch: "+(0,c.eU)(e))}}}function _buildRequestDetails(e,n){var t={url:q,hdrs:{},useHdrs:!1};n?(t.hdrs=(0,u.l7)(t.hdrs,$),t.useHdrs=(0,l.FY)(t.hdrs).length>0):(0,l.rW)($,(function(e,n){ee[e]?_addRequestDetails(t,ee[e],n,!1):(t.hdrs[e]=n,t.useHdrs=!0)})),_addRequestDetails(t,x,"NO_AUTH",n),_addRequestDetails(t,w,u.vs,n);var a=y;(0,l.tO)(e.apiKeys,(function(e){a.length>0&&(a+=","),a+=e})),_addRequestDetails(t,O,a,n),_addRequestDetails(t,A,(0,l.m6)().toString(),n);var r=function _getMsfpc(e){for(var n=0;n<e.batches.length;n++){var t=e.batches[n].Msfpc();if(t)return encodeURIComponent(t)}return y}(e);if((0,u.Sn)(r)&&(t.url+="&ext.intweb.msfpc="+r),U.shouldAddClockSkewHeaders()&&_addRequestDetails(t,k,U.getClockSkewHeaderValue(),n),v.getWParam){var i=v.getWParam();i>=0&&(t.url+="&w="+i)}for(var o=0;o<X.length;o++)t.url+="&"+X[o].name+"="+X[o].value;return t}function _setTimingValue(e,n,t){e[n]=e[n]||{},e[n][s.identifier]=t}function _doPayloadSend(e,n,a,o){if(e&&e.payloadBlob&&e.payloadBlob.length>0){var _=!!r.sendHook,y=h[e.sendType];!_isBeaconPayload(e.sendType)&&e.isBeacon&&2===e.sendReason&&(y=h[2]||h[3]||y);var m=ie;(e.isBeacon||3===y._transport)&&(m=!1);var g=_buildRequestDetails(e,m);m=m||g.useHdrs;var S=(0,u.hK)();(0,i.Lm)(v,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var h=0;h<e.batches.length;h++)for(var b=e.batches[h].events(),w=0;w<b.length;w++){var x=b[w];if(ae){var k=x.timings=x.timings||{};_setTimingValue(k,"sendEventStart",S),_setTimingValue(k,"serializationStart",n),_setTimingValue(k,"serializationCompleted",a)}x[Z]>0?x[Z]++:x[Z]=1}_sendBatchesNotification(e.batches,1e3+(o||0),e.sendType,!0);var A={data:e.payloadBlob,urlString:g.url,headers:g.hdrs,_thePayload:e,_sendReason:o,timeout:p,disableXhrSync:T,disableFetchKeepAlive:K};m&&(_hasHeader(A.headers,P)||(A.headers[P]="no-cache, no-store"),_hasHeader(A.headers,C)||(A.headers[C]=E));var O=null;y&&(O=function(n){U.firstRequestSent();var onComplete=function(n,a){!function _retryRequestIfNeeded(e,n,a,i){var o=9e3,c=null,d=!1,f=!1;try{var h=!0;if(typeof e!==N.jA){if(n){U.setClockSkew(n[M]);var v=n[B]||n["kill-duration-seconds"];(0,l.tO)(D.setKillSwitchTenants(n[R],v),(function(e){(0,l.tO)(a.batches,(function(n){if(n.iKey()===e){c=c||[];var t=n.split(0);a.numEvents-=t.count(),c.push(t)}}))}))}if(200==e||204==e)return void(o=200);(!function retryPolicyShouldRetryForStatus(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)}(e)||a.numEvents<=0)&&(h=!1),o=9e3+e%1e3}if(h){o=100;var _=a.retryCnt;0===a.sendType&&(_<t?(d=!0,_doAction((function(){0===a.sendType&&W--,_sendBatches(a.batches,_+1,a.isTeardown,re?2:a.sendType,5)}),re,retryPolicyGetMillisToBackoffForRetry(_))):(f=!0,re&&(o=8001)))}}finally{d||(U.setClockSkew(),function _handleRequestFinished(e,n,t,a){try{a&&s._backOffTransmission(),200===n&&(a||e.isSync||s._clearBackOff(),function _addCompleteTimings(e){if(ae){var n=(0,u.hK)();(0,l.tO)(e,(function(e){e&&e.count()>0&&function _addEventCompletedTimings(e,n){ae&&(0,l.tO)(e,(function(e){_setTimingValue(e.timings=e.timings||{},"sendEventCompleted",n)}))}(e.events(),n)}))}}(e.batches)),_sendBatchesNotification(e.batches,n,e.sendType,!0)}finally{0===e.sendType&&(W--,5!==t&&r.sendQueuedRequests(e.sendType,t))}}(a,o,i,f)),_sendBatchesNotification(c,8004,a.sendType)}}(n,a,e,o)},a=e.isTeardown||e.isSync;try{y.sendPOST(n,onComplete,a),r.sendListener&&r.sendListener(A,n,a,e.isBeacon)}catch(e){(0,f.jV)(d,"Unexpected exception sending payload. Ex:"+(0,c.eU)(e)),_doOnComplete(onComplete,0,{})}}),(0,i.Lm)(v,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(O)if(0===e.sendType&&W++,_&&!e.isBeacon&&3!==y._transport){var n={data:A.data,urlString:A.urlString,headers:(0,u.l7)({},A.headers),timeout:A.timeout,disableXhrSync:A.disableXhrSync,disableFetchKeepAlive:A.disableFetchKeepAlive},t=!1;(0,i.Lm)(v,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{r.sendHook(n,(function(e){t=!0,J||e._thePayload||(e._thePayload=e._thePayload||A._thePayload,e._sendReason=e._sendReason||A._sendReason),O(e)}),e.isSync||e.isTeardown)}catch(e){t||O(A)}}))}else O(A)}))}),(function(){return{thePayload:e,serializationStart:n,serializationCompleted:a,sendReason:o}}),e.isSync)}e.sizeExceed&&e.sizeExceed.length>0&&_sendBatchesNotification(e.sizeExceed,8003,e.sendType),e.failedEvts&&e.failedEvts.length>0&&_sendBatchesNotification(e.failedEvts,8002,e.sendType)}function _doAction(e,n,t){n?e():o.set(e,t)}function _handleCollectorResponse(e){var n=r._responseHandlers;try{for(var t=0;t<n.length;t++)try{n[t](e)}catch(e){(0,f.kP)(d,1,519,"Response handler failed: "+e)}if(e){var a=JSON.parse(e);(0,u.Sn)(a.webResult)&&(0,u.Sn)(a.webResult[L])&&_.set("MSFPC",a.webResult[L],31536e3)}}catch(e){}}function _sendBatchesNotification(e,n,t,r){if(e&&e.length>0&&a){var o=a[function _getNotificationAction(e){var n=G[e];(0,u.Sn)(n)||(n="oth",e>=9e3&&e<=9999?n=b:e>=8e3&&e<=8999?n=g:e>=1e3&&e<=1999&&(n=S));return n}(n)];if(o){var s=0!==t;(0,i.Lm)(v,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){_doAction((function(){try{o.call(a,e,n,s,t)}catch(e){(0,f.kP)(d,1,74,"send request notification failed: "+e)}}),r||s,0)}),(function(){return{batches:_createDebugBatches(e),reason:n,isSync:s,sendSync:r,sendType:t}}),!s)}}}r.initialize=function(e,n,t,a,r){var i;r||(r={}),q=e+q,ie=!!(0,l.o8)(r.avoidOptions)||!r.avoidOptions,v=n,_=n.getCookieMgr(),ae=!v.config.disableEventTimings;var o=!!v.config.enableCompoundKey;d=(s=t).diagLog();var u=r.valueSanitizer,y=r.stringifyObjects;(0,l.o8)(r.enableCompoundKey)||(o=!!r.enableCompoundKey),p=r.xhrTimeout,T=!!r.disableXhrSync,K=!!r.disableFetchKeepAlive,F=!1!==r.addNoResponse,j=!(0,c.b$)(),te=new V(v,u,y,o),(0,l.le)(r.useSendBeacon)||(j=!!r.useSendBeacon);var m=a,g=r.alwaysUseXhrOverride?a:null,S=r.alwaysUseXhrOverride?a:null,b=[3,2];if(!a){J=!1;var E=(0,c.k$)();E&&E.protocol&&"file:"===E.protocol.toLowerCase()&&(Q=!1);var P=[];(0,c.b$)()?(P=[2,1],b=[2,1,3]):P=[1,2,3],(a=_getSenderInterface(P=_prependTransports(P,r.transports),!1))||(0,f.jV)(d,"No available transport to send events"),m=_getSenderInterface(P,!0)}g||(g=_getSenderInterface(b=_prependTransports(b,r.unloadTransports),!0)),H=!J&&(j&&(0,c.MF)()||!K&&(0,c.JO)(!0)),(i={})[0]=a,i[1]=m||_getSenderInterface([1,2,3],!0),i[2]=g||m||_getSenderInterface([1],!0),i[3]=S||_getSenderInterface([2,3],!0)||m||_getSenderInterface([1],!0),h=i},r._getDbgPlgTargets=function(){return[h[0],D,te,h]},r.addQueryStringParameter=function(e,n){for(var t=0;t<X.length;t++)if(X[t].name===e)return void(X[t].value=n);X.push({name:e,value:n})},r.addHeader=function(e,n){$[e]=n},r.canSendRequest=function(){return _hasIdleConnection()&&U.allowRequestSending()},r.sendQueuedRequests=function(e,n){(0,l.o8)(e)&&(e=0),re&&(e=_adjustSendType(e),n=2),_canSendPayload(ne,e,0)&&_sendBatches(_clearQueue(),0,!1,e,n||0)},r.isCompletelyIdle=function(){return!z&&0===W&&0===ne.length},r.setUnloading=function(e){re=e},r.addBatch=function(e){if(e&&e.count()>0){if(D.isTenantKilled(e.iKey()))return!1;ne.push(e)}return!0},r.teardown=function(){ne.length>0&&_sendBatches(_clearQueue(),0,!0,2,2)},r.pause=function(){z=!0},r.resume=function(){z=!1,r.sendQueuedRequests(0,4)},r.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&((0,l.le)(n)&&(n=1),re&&(n=_adjustSendType(n),t=2),_sendBatches([e],0,!1,n,t||0))}}))}return HttpManager.__ieDyn=1,HttpManager}();function defaultSetTimeout(e,n){for(var t=[],a=2;a<arguments.length;a++)t[a-2]=arguments[a];return setTimeout(e,n,t)}function defaultClearTimeout(e){clearTimeout(e)}function createTimeoutWrapper(e,n){return{set:e||defaultSetTimeout,clear:n||defaultClearTimeout}}var te="eventsDiscarded",ae="overrideInstrumentationKey",re="maxEventRetryAttempts",ie="maxUnloadEventRetryAttempts";const oe=function(e){function PostChannel(){var n,t=e.call(this)||this;t.identifier="PostChannel",t.priority=1011,t.version="3.2.10";var a,h,y,m,g,S,T,b=!1,E=[],P=null,C=!1,R=0,B=500,M=0,w=1e4,x={},k=v,A=null,O=null,H=0,L=0,Q={},I=-1,N=!0,z=!1,U=6,j=2;return(0,r.Z)(PostChannel,t,(function(e,t){function _handleUnloadEvents(e){"beforeunload"!==(e||(0,c.Jj)().event).type&&(z=!0,h.setUnloading(z)),_releaseAllQueues(2,2)}function _handleShowEvents(e){z=!1,h.setUnloading(z)}function _addEventToQueues(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[F]&&delete e.ext[F],e.ext&&e.ext[q]&&e.ext[q].id&&delete e.ext[q].id,N&&(u.if,e.ext=(0,l.Ax)(e.ext),e.baseData&&(e.baseData=(0,l.Ax)(e.baseData)),e.data&&(e.data=(0,l.Ax)(e.data))),e.sync)if(H||C)e.latency=3,e.sync=!1;else if(h)return N&&(e=(0,l.Ax)(e)),void h.sendSynchronousBatch(D.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var t=e.latency,a=M,r=w;4===t&&(a=R,r=B);var i=!1;if(a<r)i=!_addEventToProperQueue(e,n);else{var o=1,s=20;4===t&&(o=4,s=1),i=!0,function _dropEventWithLatencyOrLess(e,n,t,a){for(;t<=n;){var r=_getEventBatch(e,n,!0);if(r&&r.count()>0){var i=r.split(0,a),o=i.count();if(o>0)return 4===t?R-=o:M-=o,_notifyBatchEvents(te,[i],d.h.QueueFull),!0}t++}return _resetQueueCounts(),!1}(e.iKey,e.latency,o,s)&&(i=!_addEventToProperQueue(e,n))}i&&_notifyEvents(te,[e],d.h.QueueFull)}function _sendEventsForLatencyAndAbove(e,n,t){var a=_queueBatches(e,n,t);return h.sendQueuedRequests(n,t),a}function _hasEvents(){return M>0}function _scheduleTimer(){if(I>=0&&_queueBatches(I,0,g)&&h.sendQueuedRequests(0,g),R>0&&!O&&!C){var e=x[k][2];e>=0&&(O=_createTimer((function(){O=null,_sendEventsForLatencyAndAbove(4,0,1),_scheduleTimer()}),e))}var n=x[k][1];!A&&!P&&n>=0&&!C&&(_hasEvents()?A=_createTimer((function(){A=null,_sendEventsForLatencyAndAbove(0===L?3:1,0,1),L++,L%=2,_scheduleTimer()}),n):L=0)}function _initDefaults(){n=null,b=!1,E=[],P=null,C=!1,R=0,B=500,M=0,w=1e4,x={},k=v,A=null,O=null,H=0,L=0,a=null,Q={},y=void 0,m=0,I=-1,g=null,N=!0,z=!1,U=6,j=2,S=null,T=createTimeoutWrapper(),h=new ne(500,2,1,{requeue:_requeueEvents,send:_sendingEvent,sent:_eventsSentEvent,drop:_eventsDropped,rspFail:_eventsResponseFail,oth:_otherEvent},T),_initializeProfiles(),function _clearQueues(){Q[4]={batches:[],iKeyMap:{}},Q[3]={batches:[],iKeyMap:{}},Q[2]={batches:[],iKeyMap:{}},Q[1]={batches:[],iKeyMap:{}}}(),_setAutoLimits()}function _createTimer(e,n){0===n&&H&&(n=1);var t=1e3;return H&&(t=retryPolicyGetMillisToBackoffForRetry(H-1)),T.set(e,n*t)}function _clearScheduledTimer(){return null!==A&&(T.clear(A),A=null,L=0,!0)}function _releaseAllQueues(e,n){_clearScheduledTimer(),P&&(T.clear(P),P=null),C||_sendEventsForLatencyAndAbove(1,e,n)}function _getEventBatch(e,n,t){var a=Q[n];a||(a=Q[n=1]);var r=a.iKeyMap[e];return!r&&t&&(r=D.create(e),a.batches.push(r),a.iKeyMap[e]=r),r}function _performAutoFlush(n,t){h.canSendRequest()&&!H&&(y>0&&M>y&&(t=!0),t&&null==P&&e.flush(n,null,20))}function _addEventToProperQueue(e,n){N&&(e=(0,l.Ax)(e));var t=e.latency,a=_getEventBatch(e.iKey,t,!0);return!!a.addEvent(e)&&(4!==t?(M++,n&&0===e.sendAttempt&&_performAutoFlush(!e.sync,m>0&&a.count()>=m)):R++,!0)}function _resetQueueCounts(){for(var e=0,n=0,_loop_1=function(t){var a=Q[t];a&&a.batches&&(0,l.tO)(a.batches,(function(a){4===t?e+=a.count():n+=a.count()}))},t=1;t<=4;t++)_loop_1(t);M=n,R=e}function _queueBatches(n,t,a){var r=!1,o=0===t;return!o||h.canSendRequest()?(0,i.Lm)(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],t=4;t>=n;){var a=Q[t];a&&a.batches&&a.batches.length>0&&((0,l.tO)(a.batches,(function(n){h.addBatch(n)?r=r||n&&n.count()>0:e=e.concat(n.events()),4===t?R-=n.count():M-=n.count()})),a.batches=[],a.iKeyMap={}),t--}e.length>0&&_notifyEvents(te,e,d.h.KillSwitch),r&&I>=n&&(I=-1,g=0)}),(function(){return{latency:n,sendType:t,sendReason:a}}),!o):(I=I>=0?Math.min(I,n):n,g=Math.max(g,a)),r}function _flushImpl(e,n){_sendEventsForLatencyAndAbove(1,0,n),_resetQueueCounts(),_waitForIdleManager((function(){e&&e(),E.length>0?P=_createTimer((function(){P=null,_flushImpl(E.shift(),n)}),0):(P=null,_scheduleTimer())}))}function _waitForIdleManager(e){h.isCompletelyIdle()?e():P=_createTimer((function(){P=null,_waitForIdleManager(e)}),.25)}function _initializeProfiles(){(x={})[v]=[2,1,0],x[_]=[6,3,0],x[p]=[18,9,0]}function _requeueEvents(n,t){var a=[],r=U;z&&(r=j),(0,l.tO)(n,(function(n){n&&n.count()>0&&(0,l.tO)(n.events(),(function(n){n&&(n.sync&&(n.latency=4,n.sync=!1),n.sendAttempt<r?((0,u.if)(n,e.identifier),_addEventToQueues(n,!1)):a.push(n))}))})),a.length>0&&_notifyEvents(te,a,d.h.NonRetryableStatus),z&&_releaseAllQueues(2,2)}function _callNotification(n,t){var a=e._notificationManager||{},r=a[n];if(r)try{r.apply(a,t)}catch(t){(0,f.kP)(e.diagLog(),1,74,n+" notification failed: "+t)}}function _notifyEvents(e,n){for(var t=[],a=2;a<arguments.length;a++)t[a-2]=arguments[a];n&&n.length>0&&_callNotification(e,[n].concat(t))}function _notifyBatchEvents(e,n){for(var t=[],a=2;a<arguments.length;a++)t[a-2]=arguments[a];n&&n.length>0&&(0,l.tO)(n,(function(n){n&&n.count()>0&&_callNotification(e,[n.events()].concat(t))}))}function _sendingEvent(e,n,t){e&&e.length>0&&_callNotification("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])}function _eventsSentEvent(e,n){_notifyBatchEvents("eventsSent",e,n),_scheduleTimer()}function _eventsDropped(e,n){_notifyBatchEvents(te,e,n>=8e3&&n<=8999?n-8e3:d.h.Unknown)}function _eventsResponseFail(e){_notifyBatchEvents(te,e,d.h.NonRetryableStatus),_scheduleTimer()}function _otherEvent(e,n){_notifyBatchEvents(te,e,d.h.Unknown),_scheduleTimer()}function _setAutoLimits(){m=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,w/6)}_initDefaults(),e._getDbgPlgTargets=function(){return[h]},e.initialize=function(r,c,d){(0,i.Lm)(c,(function(){return"PostChannel:initialize"}),(function(){var i=c;t.initialize(r,c,d);try{c.addUnloadCb;S=(0,o.jU)((0,s.J)(e.identifier),c.evtNamespace&&c.evtNamespace());var f=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},n=f.getExtCfg(e.identifier),T=createTimeoutWrapper(n.setTimeoutOverride,n.clearTimeoutOverride),N=!n.disableOptimizeObj&&(0,u.mJ)(),function _hookWParam(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(i),n.eventsLimitInMem>0&&(w=n.eventsLimitInMem),n.immediateEventLimit>0&&(B=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(y=n.autoFlushEventsLimit),(0,l.hj)(n[re])&&(U=n[re]),(0,l.hj)(n[ie])&&(j=n[ie]),_setAutoLimits(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(a=n.httpXHROverride),(0,u.Sn)(r.anonCookieName)&&h.addQueryStringParameter("anoncknm",r.anonCookieName),h.sendHook=n.payloadPreprocessor,h.sendListener=n.payloadListener;var v=n.overrideEndpointUrl?n.overrideEndpointUrl:r.endpointUrl;e._notificationManager=c.getNotifyMgr(),h.initialize(v,e.core,e,a,n);var _=r.disablePageUnloadEvents||[];(0,o.c9)(_handleUnloadEvents,_,S),(0,o.TJ)(_handleUnloadEvents,_,S),(0,o.nD)(_handleShowEvents,r.disablePageShowEvents,S)}catch(n){throw e.setInitialized(!1),n}}),(function(){return{coreConfig:r,core:c,extensions:d}}))},e.processTelemetry=function(t,a){(0,u.if)(t,e.identifier);var r=(a=e._getTelCtx(a)).getExtCfg(e.identifier),i=!!n.disableTelemetry;r&&(i=i||!!r.disableTelemetry);var o=t;i||b||(n[ae]&&(o.iKey=n[ae]),r&&r[ae]&&(o.iKey=r[ae]),_addEventToQueues(o,!0),z?_releaseAllQueues(2,2):_scheduleTimer()),e.processNext(o,a)},e._doTeardown=function(e,n){_releaseAllQueues(2,2),b=!0,h.teardown(),(0,o.JA)(null,S),(0,o.C9)(null,S),(0,o.Yl)(null,S),_initDefaults()},e.setEventQueueLimits=function(e,n){w=e>0?e:1e4,y=n>0?n:0,_setAutoLimits();var t=M>e;if(!t&&m>0)for(var a=1;!t&&a<=3;a++){var r=Q[a];r&&r.batches&&(0,l.tO)(r.batches,(function(e){e&&e.count()>=m&&(t=!0)}))}_performAutoFlush(!0,t)},e.pause=function(){_clearScheduledTimer(),C=!0,h.pause()},e.resume=function(){C=!1,h.resume(),_scheduleTimer()},e.addResponseHandler=function(e){h._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){!function _resetTransmitProfiles(){_clearScheduledTimer(),_initializeProfiles(),k=v,_scheduleTimer()}(),(0,l.rW)(e,(function(e,n){var t=n.length;if(t>=2){var a=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var r=n[0]/n[1];n[0]=Math.ceil(r)*n[1]}a>=0&&n[1]>=0&&a>n[1]&&(a=n[1]),n.push(a),x[e]=n}}))},e.flush=function(e,n,t){if(void 0===e&&(e=!0),!C)if(t=t||1,e)null==P?(_clearScheduledTimer(),_queueBatches(1,0,t),P=_createTimer((function(){P=null,_flushImpl(n,t)}),0)):E.push(n);else{var a=_clearScheduledTimer();_sendEventsForLatencyAndAbove(1,1,t),null!=n&&n(),a&&_scheduleTimer()}},e.setMsaAuthTicket=function(e){h.addHeader(K,e)},e.hasEvents=_hasEvents,e._setTransmitProfile=function(e){k!==e&&void 0!==x[e]&&(_clearScheduledTimer(),k=e,_scheduleTimer())},e._backOffTransmission=function(){H<4&&(H++,_clearScheduledTimer(),_scheduleTimer())},e._clearBackOff=function(){H&&(H=0,_clearScheduledTimer(),_scheduleTimer())},(0,l.l_)(e,"_setTimeoutOverride",(function(){return T.set}),(function(e){T=createTimeoutWrapper(e,T.clear)})),(0,l.l_)(e,"_clearTimeoutOverride",(function(){return T.clear}),(function(e){T=createTimeoutWrapper(T.set,e)}))})),t}return(0,a.ne)(PostChannel,e),PostChannel.__ieDyn=1,PostChannel}(h.i)}};